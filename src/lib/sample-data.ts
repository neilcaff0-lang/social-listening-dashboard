import { RawDataRow } from '@/types';

/**
 * 示例数据 - 用于测试数据解析和展示功能
 * 包含 3 个品类的社交媒体数据
 */
export const sampleData: RawDataRow[] = [
  // 2024年1月数据
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '美妆护肤',
    KEYWORDS: '粉底液',
    小红书_Buzz: 12500,
    抖音_Buzz: 8900,
    TTL_Buzz: 21400,
    TTL_Buzz_YOY: 15.2,
    TTL_Buzz_MOM: 5.8,
    小红书_SEARCH: 45200,
    小红书_SEARCH_vs_Dec: 8.5,
    抖音_SEARCH: 32100,
    抖音_SEARCH_vs_Dec: 12.3,
    象限图: '第二象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '美妆护肤',
    KEYWORDS: '口红',
    小红书_Buzz: 25800,
    抖音_Buzz: 18200,
    TTL_Buzz: 44000,
    TTL_Buzz_YOY: 22.5,
    TTL_Buzz_MOM: 10.2,
    小红书_SEARCH: 89600,
    小红书_SEARCH_vs_Dec: 15.8,
    抖音_SEARCH: 65400,
    抖音_SEARCH_vs_Dec: 18.2,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '美妆护肤',
    KEYWORDS: '面霜',
    小红书_Buzz: 9800,
    抖音_Buzz: 7200,
    TTL_Buzz: 17000,
    TTL_Buzz_YOY: -5.3,
    TTL_Buzz_MOM: -2.1,
    小红书_SEARCH: 32500,
    小红书_SEARCH_vs_Dec: 3.2,
    抖音_SEARCH: 21800,
    抖音_SEARCH_vs_Dec: 1.5,
    象限图: '第四象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '母婴用品',
    KEYWORDS: '婴儿推车',
    小红书_Buzz: 6500,
    抖音_Buzz: 4200,
    TTL_Buzz: 10700,
    TTL_Buzz_YOY: 8.5,
    TTL_Buzz_MOM: 3.2,
    小红书_SEARCH: 18500,
    小红书_SEARCH_vs_Dec: 5.8,
    抖音_SEARCH: 12800,
    抖音_SEARCH_vs_Dec: 6.5,
    象限图: '第三象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '母婴用品',
    KEYWORDS: '纸尿裤',
    小红书_Buzz: 8200,
    抖音_Buzz: 15600,
    TTL_Buzz: 23800,
    TTL_Buzz_YOY: 12.8,
    TTL_Buzz_MOM: 8.5,
    小红书_SEARCH: 28500,
    小红书_SEARCH_vs_Dec: 10.2,
    抖音_SEARCH: 42000,
    抖音_SEARCH_vs_Dec: 15.8,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '母婴用品',
    KEYWORDS: '奶瓶',
    小红书_Buzz: 3200,
    抖音_Buzz: 2800,
    TTL_Buzz: 6000,
    TTL_Buzz_YOY: -8.2,
    TTL_Buzz_MOM: -5.5,
    小红书_SEARCH: 8500,
    小红书_SEARCH_vs_Dec: -2.3,
    抖音_SEARCH: 6200,
    抖音_SEARCH_vs_Dec: -3.8,
    象限图: '第四象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '食品饮料',
    KEYWORDS: '咖啡',
    小红书_Buzz: 15200,
    抖音_Buzz: 22500,
    TTL_Buzz: 37700,
    TTL_Buzz_YOY: 28.5,
    TTL_Buzz_MOM: 12.5,
    小红书_SEARCH: 52000,
    小红书_SEARCH_vs_Dec: 18.2,
    抖音_SEARCH: 78500,
    抖音_SEARCH_vs_Dec: 25.8,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '食品饮料',
    KEYWORDS: '零食',
    小红书_Buzz: 18500,
    抖音_Buzz: 35800,
    TTL_Buzz: 54300,
    TTL_Buzz_YOY: 35.2,
    TTL_Buzz_MOM: 15.8,
    小红书_SEARCH: 62500,
    小红书_SEARCH_vs_Dec: 22.5,
    抖音_SEARCH: 98500,
    抖音_SEARCH_vs_Dec: 32.5,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '1月',
    CATEGORY: '食品饮料',
    KEYWORDS: '保健品',
    小红书_Buzz: 5800,
    抖音_Buzz: 4200,
    TTL_Buzz: 10000,
    TTL_Buzz_YOY: 2.5,
    TTL_Buzz_MOM: 1.2,
    小红书_SEARCH: 15200,
    小红书_SEARCH_vs_Dec: 4.2,
    抖音_SEARCH: 10500,
    抖音_SEARCH_vs_Dec: 3.8,
    象限图: '第三象限',
  },

  // 2024年2月数据
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '美妆护肤',
    KEYWORDS: '粉底液',
    小红书_Buzz: 13800,
    抖音_Buzz: 9500,
    TTL_Buzz: 23300,
    TTL_Buzz_YOY: 18.5,
    TTL_Buzz_MOM: 8.9,
    小红书_SEARCH: 48500,
    小红书_SEARCH_vs_Dec: 7.3,
    抖音_SEARCH: 35200,
    抖音_SEARCH_vs_Dec: 9.7,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '美妆护肤',
    KEYWORDS: '口红',
    小红书_Buzz: 28500,
    抖音_Buzz: 19800,
    TTL_Buzz: 48300,
    TTL_Buzz_YOY: 25.8,
    TTL_Buzz_MOM: 9.8,
    小红书_SEARCH: 96500,
    小红书_SEARCH_vs_Dec: 7.7,
    抖音_SEARCH: 71200,
    抖音_SEARCH_vs_Dec: 8.9,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '美妆护肤',
    KEYWORDS: '面霜',
    小红书_Buzz: 10200,
    抖音_Buzz: 7800,
    TTL_Buzz: 18000,
    TTL_Buzz_YOY: -2.5,
    TTL_Buzz_MOM: 5.9,
    小红书_SEARCH: 34500,
    小红书_SEARCH_vs_Dec: 6.2,
    抖音_SEARCH: 23200,
    抖音_SEARCH_vs_Dec: 6.4,
    象限图: '第三象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '母婴用品',
    KEYWORDS: '婴儿推车',
    小红书_Buzz: 7200,
    抖音_Buzz: 4800,
    TTL_Buzz: 12000,
    TTL_Buzz_YOY: 10.2,
    TTL_Buzz_MOM: 12.1,
    小红书_SEARCH: 20500,
    小红书_SEARCH_vs_Dec: 10.8,
    抖音_SEARCH: 14500,
    抖音_SEARCH_vs_Dec: 13.3,
    象限图: '第二象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '母婴用品',
    KEYWORDS: '纸尿裤',
    小红书_Buzz: 8800,
    抖音_Buzz: 16800,
    TTL_Buzz: 25600,
    TTL_Buzz_YOY: 15.2,
    TTL_Buzz_MOM: 7.6,
    小红书_SEARCH: 30500,
    小红书_SEARCH_vs_Dec: 7.0,
    抖音_SEARCH: 45500,
    抖音_SEARCH_vs_Dec: 8.3,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '母婴用品',
    KEYWORDS: '奶瓶',
    小红书_Buzz: 3500,
    抖音_Buzz: 3100,
    TTL_Buzz: 6600,
    TTL_Buzz_YOY: -5.2,
    TTL_Buzz_MOM: 10.0,
    小红书_SEARCH: 9200,
    小红书_SEARCH_vs_Dec: 8.2,
    抖音_SEARCH: 6800,
    抖音_SEARCH_vs_Dec: 9.7,
    象限图: '第三象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '食品饮料',
    KEYWORDS: '咖啡',
    小红书_Buzz: 16800,
    抖音_Buzz: 24500,
    TTL_Buzz: 41300,
    TTL_Buzz_YOY: 32.5,
    TTL_Buzz_MOM: 9.5,
    小红书_SEARCH: 57500,
    小红书_SEARCH_vs_Dec: 10.6,
    抖音_SEARCH: 86500,
    抖音_SEARCH_vs_Dec: 10.2,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '食品饮料',
    KEYWORDS: '零食',
    小红书_Buzz: 20200,
    抖音_Buzz: 38500,
    TTL_Buzz: 58700,
    TTL_Buzz_YOY: 38.5,
    TTL_Buzz_MOM: 8.1,
    小红书_SEARCH: 68200,
    小红书_SEARCH_vs_Dec: 9.1,
    抖音_SEARCH: 106500,
    抖音_SEARCH_vs_Dec: 8.1,
    象限图: '第一象限',
  },
  {
    YEAR: 2024,
    MONTH: '2月',
    CATEGORY: '食品饮料',
    KEYWORDS: '保健品',
    小红书_Buzz: 6200,
    抖音_Buzz: 4600,
    TTL_Buzz: 10800,
    TTL_Buzz_YOY: 5.2,
    TTL_Buzz_MOM: 8.0,
    小红书_SEARCH: 16500,
    小红书_SEARCH_vs_Dec: 8.6,
    抖音_SEARCH: 11500,
    抖音_SEARCH_vs_Dec: 9.5,
    象限图: '第二象限',
  },
];

/**
 * 获取所有品类列表
 */
export function getCategories(): string[] {
  const categories = new Set(sampleData.map((row) => row.CATEGORY));
  return Array.from(categories);
}

/**
 * 获取所有时间维度
 */
export function getTimeDimensions(): Array<{ year: number; month: string }> {
  const timeSet = new Set(
    sampleData.map((row) => `${row.YEAR}-${row.MONTH}`)
  );
  return Array.from(timeSet).map((time) => {
    const [year, month] = time.split('-');
    return { year: parseInt(year), month };
  });
}

/**
 * 获取所有关键词
 */
export function getKeywords(): string[] {
  const keywords = new Set(sampleData.map((row) => row.KEYWORDS));
  return Array.from(keywords);
}

/**
 * 按品类筛选数据
 */
export function filterByCategory(category: string): RawDataRow[] {
  return sampleData.filter((row) => row.CATEGORY === category);
}

/**
 * 按时间筛选数据
 */
export function filterByTime(year: number, month: string): RawDataRow[] {
  return sampleData.filter((row) => row.YEAR === year && row.MONTH === month);
}

/**
 * 导出示例数据为 Excel 格式的 Blob
 */
export function getSampleDataExcelBlob(): Blob {
  // eslint-disable-next-line @typescript-eslint/no-require-imports
  const XLSX = require('xlsx');
  const worksheet = XLSX.utils.json_to_sheet(sampleData);
  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, '示例数据');
  const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
  return new Blob([excelBuffer], {
    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
  });
}
